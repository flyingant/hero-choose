{"ts":1375754887448,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var HeroSelectView = Backbone.View.extend({\n\n    events:{\n        \"click a[data-action=list]\": \"_listAll\",\n        \"click a[data-action=selectMaster]\": \"_filterWithMaster\",\n        \"click a[data-action=select]\": \"_filter\",\n        \"click .item.active\":\"_select\",\n        \"click a[data-action=search]\": \"_search\",\n        \"click a[data-action=back]\": \"_back\"\n    },\n\n    template: function(){\n        return Handlebars.compile($(\"#heroItemsTemplate\").html())\n    },\n\n    initialize: function(){\n        console.log(\"Initialize ... Hero size\",this.collection.size());\n        this.on(\"render\", this.render, this);\n    },\n\n    render: function(){\n        var self = this;\n        this.$(\".carousel-inner\").html(self.template()({\n            heros: self.filterHeros\n        }));\n        this.$(\".carousel-inner div:first-child\").addClass(\"active\");\n        $(\"#viewHerosPanle\").carousel({\n            interval: 2000000\n        });\n        this._hideOperations();\n        this._showHeroZone();\n    },\n\n    _hideOperations: function(){\n        this.$(\".operations\").hide();\n    },\n\n    displayOperations: function(){\n        this.$(\".operations\").show();\n    },\n\n    _filter: function(){\n        this.filterHeros = new Array();\n        for(var i=0;i<5;i++){\n            this.filterHeros.push(this.filterOne());\n        }\n        this.trigger(\"render\");\n    },\n\n    _listAll: function(){\n        this.filterHeros = new Array();\n        this.filterHeros = _.shuffle(this.collection.toJSON());\n        this.trigger(\"render\");\n    },\n\n    _search: function(){\n        var self = this;\n        var searchString = this.$(\"input[type=text]\").val();\n        if(!searchString){\n            alert(\"点你妹啊！\");\n            return\n        }\n        this.filterHeros = new Array();\n        var hero = _.find(self.collection.toJSON(),function(h){\n            return h.name === searchString\n        });\n        if(hero){\n            this.filterHeros.push(hero);\n            this.trigger(\"render\");\n        } else {\n            alert(\"你确定有这货！\");\n            return\n        }\n    },\n\n    _filterWithMaster: function(){\n        var self = this;\n        this.filterHeros = new Array();\n        this.filterHeros = this.collection.filterMasterHeros();\n        for(var i=0;i<5;i++){\n            this.filterHeros.push(self.filterOne());\n        }\n        this.trigger(\"render\");\n    },\n\n    filterOne: function(){\n        var self = this;\n        while(true){\n            var hero = _.first(self.collection.shuffle()).toJSON();\n            if(_.find(self.filterHeros, function(h){\n                return h.name === hero.name\n            }) === undefined ){\n                return hero;\n            }\n        };\n    },\n\n    _hideHeroZone: function(){\n        this.$(\".heroZone\").hide();\n    },\n\n    _showHeroZone: function(){\n        this.$(\".heroZone\").show();\n    },\n\n    _hideViewHero: function(){\n        this.$(\".viewHero\").hide();\n    },\n\n    _showViewHero: function(){\n        this.$(\".viewHero\").show();\n    },\n\n    _select: function(event){\n        var heroUrl = $(event.currentTarget).data(\"url\");\n        this.$(\".viewHero\").html(\"<img class='selectedHero' src='\"+heroUrl+\"'></img><a class='btn btn-danger' data-action='back'>BBBBBBBBBBBACK</a>\");\n        this._hideOperations();\n        this._hideHeroZone();\n        this._showViewHero();\n    },\n\n    _back: function(){\n        this._hideViewHero();\n        this.displayOperations();\n    }\n})"]],"start1":0,"start2":0,"length1":0,"length2":3421}]],"length":3421}
{"contributors":[],"silentsave":false,"ts":1375758137792,"patch":[[{"diffs":[[0,"shuffle("],[1,"\n            _.find("],[0,"this.col"]],"start1":1450,"start2":1450,"length1":16,"length2":36},{"diffs":[[0,"toJSON()"],[1,", function(item){\n                return item.available == true    \n            })"],[0,");\n     "]],"start1":1494,"start2":1494,"length1":16,"length2":98}]],"length":3523,"saved":false}
